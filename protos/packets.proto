syntax = "proto3";

service Greeter {
  rpc GetAccessPoint(GetAPRequest) returns (AP) {}
  rpc GetAllAccessPoints(Empty) returns (SSIDList) {}
  rpc ProvidePassword(PSKRequest) returns (PSKResponse) {}
  rpc GetDecryptedPackets(PacketRequest) returns (stream Packet) {}
}

message PacketRequest { string ssid = 1; }

message Packet {
  User from = 1;
  User to = 2;
  string protocol = 3; // For now TCP/UDP
  bytes data = 4;
}

message Empty {}

message PSKResponse { bool success = 1; }

message GetAPRequest { string ssid = 1; }

message SSIDList { repeated string names = 1; }

message PSKRequest {
  string ssid = 1;
  string passwd = 2;
}

message AP {
  string bssid = 1;
  string name = 2;
  int64 channel = 3;
}

message User {
  string MACAddress = 1;
  string IPv4Address = 2;
  int64 port = 3;
}
